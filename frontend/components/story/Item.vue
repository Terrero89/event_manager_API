<script setup lang="ts">
// import CONFIG from '@/config'; // Adjust the path as needed

import { computed, ref } from "vue";

const props = defineProps([
  "_id",
  "storyNumber", // DMR-xxxx
  "storyName", // C2T xxx
  "storyDescription", // description
  "difficultyLevel", // easy, medium, hard
  "storyPoints", // 1, 2, 3, 5, 8, 13
  "workType", // feature, bug, production
  "developmentType", // frontend, backend, fullstack
  "status", // to do, in progress, demo ready, completed, released
  "storyComments",
  "reporter", // reported who assigned story
  "repoNames", // repo we are going to work on
  "dateAssigned",
  "dateCompleted",
  "sprintId", // PL!, 2 etcc
  "learning", // comments on learning
"createdAt",
  "updatedAt",
]);


const developmentTypeColor = computed(() => {
  switch (props.developmentType) {
    case 'Frontend':
      return 'blue';
    case 'Backend':
      return 'purple';
    case 'Fullstack':
      return 'teal';
    default:
      return 'black';
  }
});

const workTypeColor = computed(() => {
  switch (props.workType) {
    case 'Story':
      return 'blue';
    case 'Spike':
      return 'teal';
    case 'Bug':
      return 'purple';
    case 'Feature':
      return 'blue';
    case 'non-prod':
      return 'orange';
    case 'Epic':
      return 'green';
    case 'Tech Debt':
      return 'red';
    case 'Epic':
 
    default:
      return 'black';
  }
});

const progressColor = computed(() => {
  switch (props.status) {
    case 'Completed':
      return 'blue';
    case 'In Progress':
      return 'orange';
    case 'Pending':
      return 'purple';
    case 'Backlog':
      return 'teal';
    case 'Review':
      return 'green';
    case 'Done':
      return 'yellow';

    case 'Epic':
 
    default:
      return 'black';
  }
});



const isOpen = ref(false);
</script>


<template>
  <div>
   <!-- change color based on development, workType etc. -->
    <UIRenderer>
      <div class="item">
        <p><strong>Sprint Id:</strong> {{ props.sprintId}}</p>
        <p><strong>Story Name:</strong> {{ props.storyName }}</p>

        <div class="item-header">
        
          <p><strong>Development: </strong> <UBadge :color="developmentTypeColor" variant="soft"> {{ props.developmentType }}</UBadge></p>


 
               <p><strong>Work Type:</strong> <UBadge :color="workTypeColor" variant="soft"> {{ props.workType }}</UBadge></p>
        </div>
         <p><strong>Status:</strong> <UBadge :color="progressColor" variant="soft"> {{ props.status }}</UBadge></p>
        <div class="item-content">
          <div>
            <p><strong>Start Date: </strong> {{ formatDate(props.dateAssigned) }}</p>
            <p><strong>End Date: </strong> {{ formatDate(props.dateCompleted) ? formatDate(props.dateCompleted) : 'Not Completed' }}</p>
                       <p><strong>Points: </strong> <UBadge color="red" variant="soft"> {{ props.storyPoints }}</UBadge></p>
          </div>


        </div>
      </div>

      <div class="item-buttons my-2">
       
    <UButton variant="soft" class="" progressColor @click="isOpen = true">Details</UButton>
 

        <UModal v-model="isOpen">
          <div class="progress">
      
      <StoryDetails
      :_id="props._id"
      :storyName="props.storyName"
      :storyDescription="props.storyDescription"
      :difficultyLevel="props.difficultyLevel"
      :storyPoints="props.storyPoints"
      :workType="props.workType"
      :developmentType="props.developmentType"
      :status="props.status"
      :storyComments="props.storyComments"
      :dateAssigned="props.dateAssigned"
      :reporter="props.reporter"
      :repoNames="props.repoNames"
      :dateCompleted="props.dateCompleted"
      :sprintId="props.sprintId"
      :learning="props.learning"
      :createdAt="props.createdAt"
        :updatedAt="props.updatedAt"
    


      />
    </div>

        </UModal>
      
      </div>
    
    </UIRenderer>
    
  </div>
</template>

<style scoped>
.b {
margin-top: auto;
margin-left:auto;
/* max-width: 6rem; */
}
.item-buttons {
  display: flex;
  flex-direction: column;
  justify-content:start;
}

.item {
  margin: 0.9rem 0;
  display: flex;
}
.item-content div {
  display: flex;
  flex-wrap: wrap;
}

.item .item-header {
  display: flex;
  flex-wrap: wrap;

  font-size: 0.9rem;
  /* border:solid red 1px; */
}

.item-header p {
  margin: 0.2rem 0;
  font-size: 0.9rem;
  margin-right: 1rem;
}
.item-header strong {
  margin: 0.1rem 0;
  font-size: 0.9rem;

  margin-right: 0.5rem;
}

.item-content p {
  margin: 0.2rem 0;
  font-size: 0.9rem;

  display: flex;
  margin-right: 1rem;
  flex-wrap: wrap;
}
.item-content strong {
  margin: 0.1rem 0;
  font-size: 0.9rem;

  margin-right: 0.5rem;
}

.item {
  margin-right: auto;

  flex-direction: column;
  justify-content: flex-end;
  margin-top: 0.5rem;
  /* background-color: #007bff; */
  color: white;
}
</style>
